---
layout: post
title: "Import stock sales from Microsoft Money into TurboTax Online"
date: 2009-02-08
type: posts
tags:
 - softwaredevelopment
---

<div class='post'>
<a href="http://turbotax.intuit.com/personal-taxes/">TurboTax Online</a>'s investment sale (stock, mutual fund, etc sales for capital gains) entry screen is a nice example of braindead design. Although the application provides a "bulk-entry spreadsheet-like interface", there's no import function available. So despite having all of my data in a nice spreadsheet (exported from the MS Money capital gains report) I was still faced with the prospect of manually entering each field from dozens of transactions. Worse still, the interface limits your access to seven rows/transactions per page.<p />Applescript to the rescue! It's an ugly solution, but it saved me a ton of time and helped avoid any manual entry typos:<ol><li>Use your spreadsheet program to arrange your transaction data into columns matching those in TurboTax's interface. You should have five columns. Insure that the dates are formatted as mm/dd/yy</li><li>Copy and paste the data into your favorite text editor as tab-delimited text (I used the excellent TextMate)</li><li>Use search and replace to convert all the tabs into <div class="CodeRay">  <div class="code"><pre>&quot; &amp; tab &amp; &quot;</pre></div></div></li><li>Use search and replace to insert the following at the beginning of every line <div class="CodeRay">  <div class="code"><pre>keystroke &quot;</pre></div></div></li><li>Use search and replace to insert the following at the end of every line <div class="CodeRay">  <div class="code"><pre>&quot; &amp; tab</pre></div></div></li><li>Now each line should look something like this<div class="CodeRay">  <div class="code"><pre>keystroke &quot;ACME Stock&quot; &amp; tab &amp; &quot;11/10/08&quot; &amp; tab &amp; &quot;100.12&quot; &amp; tab &amp; &quot;1/12/05&quot; &amp; tab &amp; &quot;584.12&quot; &amp; tab</pre></div></div></li><li>Paste the following script into the Script Editor application on your Mac<div class="CodeRay">  <div class="code"><pre>tell application &quot;System Events&quot;        tell process &quot;Firefox&quot;--Clearly replace Firefox above if you are using a different browser                set frontmost to true--Transactions go here        end tellend tell</pre></div></div></li><li>Cut 7 lines at a time from your text editor, paste them into the Script Editor and click "Run"</li><li>The script will populate the TurboTax screen with your data. Click "Add more Rows" in TurboTax and repeat!</li></ol>You're welcome.</div>
